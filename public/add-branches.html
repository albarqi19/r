<!DOCTYPE html>
<html dir="rtl">
<head>
    <title>Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ±ÙˆØ¹ Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø©</title>
    <meta charset="UTF-8">
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    <script src="assets/js/firebase-service.js"></script>
</head>
<body style="font-family: Arial; padding: 20px; background: #f5f5f5;">
    <h1>Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹ (11 ÙØ±Ø¹)</h1>
    <p>Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ©/ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹ Ø§Ù„Ù€ 11 Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</p>
    <div style="margin: 15px 0; padding: 10px; background: #e8f4fd; border-left: 4px solid #2196F3; border-radius: 4px;">
        <strong>Ø§Ù„ÙØ±ÙˆØ¹ Ø§Ù„Ù…Ø´Ù…ÙˆÙ„Ø©:</strong><br>
        ØºØ±Ø¨ Ø§Ù„Ø¯Ù…Ø§Ù…ØŒ Ø´Ø±Ù‚ Ø§Ù„Ø¯Ù…Ø§Ù…ØŒ Ø§Ù„Ø±ÙÙŠØ¹Ø©ØŒ Ø¨Ù‚ÙŠÙ‚ØŒ Ø¹Ù†ÙƒØŒ ÙˆØ§Ø¯ÙŠ Ø§Ù„Ù…ÙŠØ§Ù‡ØŒ Ø§Ù„Ø®Ø¨Ø±ØŒ Ø§Ù„ØµØ±Ø§Ø±ØŒ Ø±Ø£Ø³ ØªÙ†ÙˆØ±Ø©ØŒ Ù‚Ø±ÙŠØ©ØŒ Ø§Ù„ØªØ¹ÙŠØ±ÙŠØ©
    </div>
    <button onclick="addMissingBranches()" style="background: #4CAF50; color: white; padding: 15px 30px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px;">
        Ø¥Ø¹Ø¯Ø§Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹ Ø§Ù„Ù€ 11
    </button>
    <div id="status" style="margin-top: 20px; padding: 10px; background: white; border-radius: 5px;"></div>

    <script>
        async function addMissingBranches() {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = 'â³ Ø¬Ø§Ø±ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹...';
            
            try {
                // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Firebase Service
                while (!window.firebaseService || !window.firebaseService.getAllBranches) {
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
                
                statusDiv.innerHTML += '<br>âœ… Firebase Service Ø¬Ø§Ù‡Ø²';
                
                // Ø¬Ù„Ø¨ Ø§Ù„ÙØ±ÙˆØ¹ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
                const existingResult = await window.firebaseService.getAllBranches();
                const existingBranches = existingResult.success ? existingResult.data : {};
                
                statusDiv.innerHTML += `<br>ğŸ“Š Ø§Ù„ÙØ±ÙˆØ¹ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© Ø­Ø§Ù„ÙŠØ§Ù‹: ${Object.keys(existingBranches).length}`;
                statusDiv.innerHTML += '<br>ğŸ”„ Ø¨Ø¯Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹...';
                
                // Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ø£Ùˆ ØªØ­Ø¯ÙŠØ«Ù‡Ø§ (11 ÙØ±Ø¹)
                const allBranches = {
                    'garb-dammam': {
                        id: 'garb-dammam',
                        name: 'ÙØ±Ø¹ ØºØ±Ø¨ Ø§Ù„Ø¯Ù…Ø§Ù…',
                        twitter: 'https://x.com/Org2Qer',
                        whatsapp: '966138360356',
                        instagram: 'https://www.instagram.com/org2qer/',
                        location: 'https://maps.app.goo.gl/cFQHa1b2y3uoDbGy9',
                        email: 'garb@tahfeez-sharqiya.com',
                        phone: '966138360356',
                        status: 'active',
                        region: 'Ø§Ù„Ø¯Ù…Ø§Ù…',
                        established: '1388',
                        loginEmail: 'garb.dammam@tahfeez.com',
                        loginPassword: 'Garb2024#'
                    },
                    'sharq-dammam': {
                        id: 'sharq-dammam',
                        name: 'ÙØ±Ø¹ Ø´Ø±Ù‚ Ø§Ù„Ø¯Ù…Ø§Ù…',
                        twitter: 'https://x.com/Org2Qer',
                        whatsapp: '966138360357',
                        instagram: 'https://www.instagram.com/org2qer/',
                        location: 'https://maps.app.goo.gl/cFQHa1b2y3uoDbGy9',
                        email: 'sharq@tahfeez-sharqiya.com',
                        phone: '966138360357',
                        status: 'active',
                        region: 'Ø§Ù„Ø¯Ù…Ø§Ù…',
                        established: '1390',
                        loginEmail: 'sharq.dammam@tahfeez.com',
                        loginPassword: 'Sharq2024#'
                    },
                    'rafeia': {
                        id: 'rafeia',
                        name: 'ÙØ±Ø¹ Ø§Ù„Ø±ÙÙŠØ¹Ø©',
                        twitter: 'https://x.com/Org2Qer',
                        whatsapp: '966138360358',
                        instagram: 'https://www.instagram.com/org2qer/',
                        location: 'https://maps.app.goo.gl/cFQHa1b2y3uoDbGy9',
                        email: 'rafeia@tahfeez-sharqiya.com',
                        phone: '966138360358',
                        status: 'active',
                        region: 'Ø§Ù„Ø±ÙÙŠØ¹Ø©',
                        established: '1392',
                        loginEmail: 'rafeia@tahfeez.com',
                        loginPassword: 'Rafeia2024#'
                    },
                    'baqiq': {
                        id: 'baqiq',
                        name: 'ÙØ±Ø¹ Ø¨Ù‚ÙŠÙ‚',
                        twitter: 'https://x.com/Org2Qer',
                        whatsapp: '966138360359',
                        instagram: 'https://www.instagram.com/org2qer/',
                        location: 'https://maps.app.goo.gl/cFQHa1b2y3uoDbGy9',
                        email: 'baqiq@tahfeez-sharqiya.com',
                        phone: '966138360359',
                        status: 'active',
                        region: 'Ø¨Ù‚ÙŠÙ‚',
                        established: '1394',
                        loginEmail: 'baqiq@tahfeez.com',
                        loginPassword: 'Baqiq2024#'
                    },
                    'anak': {
                        id: 'anak',
                        name: 'ÙØ±Ø¹ Ø¹Ù†Ùƒ',
                        twitter: 'https://x.com/Org2Qer',
                        whatsapp: '966138360360',
                        instagram: 'https://www.instagram.com/org2qer/',
                        location: 'https://maps.app.goo.gl/cFQHa1b2y3uoDbGy9',
                        email: 'anak@tahfeez-sharqiya.com',
                        phone: '966138360360',
                        status: 'active',
                        region: 'Ø¹Ù†Ùƒ',
                        established: '1395',
                        loginEmail: 'anak@tahfeez.com',
                        loginPassword: 'Anak2024#'
                    },
                    'wadi-almiyah': {
                        id: 'wadi-almiyah',
                        name: 'ÙØ±Ø¹ ÙˆØ§Ø¯ÙŠ Ø§Ù„Ù…ÙŠØ§Ù‡',
                        twitter: 'https://x.com/Org2Qer',
                        whatsapp: '966138360361',
                        instagram: 'https://www.instagram.com/org2qer/',
                        location: 'https://maps.app.goo.gl/cFQHa1b2y3uoDbGy9',
                        email: 'wadi@tahfeez-sharqiya.com',
                        phone: '966138360361',
                        status: 'active',
                        region: 'ÙˆØ§Ø¯ÙŠ Ø§Ù„Ù…ÙŠØ§Ù‡',
                        established: '1396',
                        loginEmail: 'wadi.almiyah@tahfeez.com',
                        loginPassword: 'Wadi2024#'
                    },
                    'khobar': {
                        id: 'khobar',
                        name: 'ÙØ±Ø¹ Ø§Ù„Ø®Ø¨Ø±',
                        twitter: 'https://x.com/Org2Qer',
                        whatsapp: '966138360362',
                        instagram: 'https://www.instagram.com/org2qer/',
                        location: 'https://maps.app.goo.gl/cFQHa1b2y3uoDbGy9',
                        email: 'khobar@tahfeez-sharqiya.com',
                        phone: '966138360362',
                        status: 'active',
                        region: 'Ø§Ù„Ø®Ø¨Ø±',
                        established: '1397',
                        loginEmail: 'khobar@tahfeez.com',
                        loginPassword: 'Khobar2024#'
                    },
                    'sarrar': {
                        id: 'sarrar',
                        name: 'ÙØ±Ø¹ Ø§Ù„ØµØ±Ø§Ø±',
                        twitter: 'https://x.com/Org2Qer',
                        whatsapp: '966138360363',
                        instagram: 'https://www.instagram.com/org2qer/',
                        location: 'https://maps.app.goo.gl/cFQHa1b2y3uoDbGy9',
                        email: 'sarrar@tahfeez-sharqiya.com',
                        phone: '966138360363',
                        status: 'active',
                        region: 'Ø§Ù„ØµØ±Ø§Ø±',
                        established: '1398',
                        loginEmail: 'sarrar@tahfeez.com',
                        loginPassword: 'Sarrar2024#'
                    },
                    'ras-tanura': {
                        id: 'ras-tanura',
                        name: 'ÙØ±Ø¹ Ø±Ø£Ø³ ØªÙ†ÙˆØ±Ø©',
                        twitter: 'https://x.com/Org2Qer',
                        whatsapp: '966138360364',
                        instagram: 'https://www.instagram.com/org2qer/',
                        location: 'https://maps.app.goo.gl/cFQHa1b2y3uoDbGy9',
                        email: 'ras-tanura@tahfeez-sharqiya.com',
                        phone: '966138360364',
                        status: 'active',
                        region: 'Ø±Ø£Ø³ ØªÙ†ÙˆØ±Ø©',
                        established: '1399',
                        loginEmail: 'ras.tanura@tahfeez.com',
                        loginPassword: 'RasTanura2024#'
                    },
                    'qarya': {
                        id: 'qarya',
                        name: 'ÙØ±Ø¹ Ù‚Ø±ÙŠØ©',
                        twitter: 'https://x.com/Org2Qer',
                        whatsapp: '966138360365',
                        instagram: 'https://www.instagram.com/org2qer/',
                        location: 'https://maps.app.goo.gl/cFQHa1b2y3uoDbGy9',
                        email: 'qarya@tahfeez-sharqiya.com',
                        phone: '966138360365',
                        status: 'active',
                        region: 'Ù‚Ø±ÙŠØ©',
                        established: '1400',
                        loginEmail: 'qarya@tahfeez.com',
                        loginPassword: 'Qarya2024#'
                    },
                    'taaeriya': {
                        id: 'taaeriya',
                        name: 'ÙØ±Ø¹ Ø§Ù„ØªØ¹ÙŠØ±ÙŠØ©',
                        twitter: 'https://x.com/Org2Qer',
                        whatsapp: '966138360366',
                        instagram: 'https://www.instagram.com/org2qer/',
                        location: 'https://maps.app.goo.gl/cFQHa1b2y3uoDbGy9',
                        email: 'taaeriya@tahfeez-sharqiya.com',
                        phone: '966138360366',
                        status: 'active',
                        region: 'Ø§Ù„ØªØ¹ÙŠØ±ÙŠØ©',
                        established: '1401',
                        loginEmail: 'taaeriya@tahfeez.com',
                        loginPassword: 'Taaeriya2024#'
                    }
                };
                
                // ØªØ­Ø¯ÙŠØ« Ø£Ùˆ Ø¥Ø¶Ø§ÙØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹
                let processedCount = 0;
                for (const [branchId, branchData] of Object.entries(allBranches)) {
                    const exists = existingBranches[branchId];
                    const action = exists ? 'ØªØ­Ø¯ÙŠØ«' : 'Ø¥Ø¶Ø§ÙØ©';
                    
                    statusDiv.innerHTML += `<br>ğŸ”„ ${action} ÙØ±Ø¹: ${branchData.name}`;
                    
                    // Ø§Ø³ØªØ®Ø¯Ø§Ù… Firebase Ù…Ø¨Ø§Ø´Ø±Ø©
                    const db = firebase.firestore();
                    await db.collection('branches').doc(branchId).set({
                        ...branchData,
                        lastUpdated: firebase.firestore.FieldValue.serverTimestamp(),
                        createdAt: exists ? existingBranches[branchId].createdAt : firebase.firestore.FieldValue.serverTimestamp()
                    }, { merge: true });
                    
                    processedCount++;
                    statusDiv.innerHTML += ` âœ…`;
                }
                
                statusDiv.innerHTML += `<br>ğŸ‰ ØªÙ… Ù…Ø¹Ø§Ù„Ø¬Ø© ${processedCount} ÙØ±ÙˆØ¹!`;
                
                // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø«Ø©
                const updatedResult = await window.firebaseService.getAllBranches();
                if (updatedResult.success) {
                    statusDiv.innerHTML += `<br>ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ±ÙˆØ¹ Ø§Ù„Ø¢Ù†: ${Object.keys(updatedResult.data).length}`;
                    
                    statusDiv.innerHTML += '<br><br><h3>ğŸ¢ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹ Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:</h3>';
                    statusDiv.innerHTML += '<table border="1" style="width:100%; border-collapse: collapse; margin-top: 10px;">';
                    statusDiv.innerHTML += '<tr style="background: #f0f0f0;"><th>Ø§Ù„ÙØ±Ø¹</th><th>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„</th><th>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</th><th>Ø§Ù„Ù‡Ø§ØªÙ</th></tr>';
                    
                    for (const [id, branch] of Object.entries(updatedResult.data)) {
                        const loginEmail = branch.loginEmail || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                        const loginPassword = branch.loginPassword || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                        const phone = branch.phone || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                        
                        statusDiv.innerHTML += `<tr>
                            <td style="padding: 8px;"><strong>${branch.name}</strong><br><small>(${id})</small></td>
                            <td style="padding: 8px;">${loginEmail}</td>
                            <td style="padding: 8px;">${loginPassword}</td>
                            <td style="padding: 8px;">${phone}</td>
                        </tr>`;
                    }
                    
                    statusDiv.innerHTML += '</table>';
                    
                    statusDiv.innerHTML += '<br><br><div style="background: #e8f5e8; padding: 10px; border-radius: 5px; border-left: 4px solid #4CAF50;">';
                    statusDiv.innerHTML += '<h4>ğŸ“‹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ù‡Ù…Ø©:</h4>';
                    statusDiv.innerHTML += '<p>â€¢ ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹ Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</p>';
                    statusDiv.innerHTML += '<p>â€¢ ÙŠÙ…ÙƒÙ† Ù„ÙƒÙ„ ÙØ±Ø¹ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¥ÙŠÙ…ÙŠÙ„Ù‡ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„Ø¯Ø®ÙˆÙ„</p>';
                    statusDiv.innerHTML += '<p>â€¢ ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø´Ø§Ø±ÙƒØ© Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„ÙØ±ÙˆØ¹</p>';
                    statusDiv.innerHTML += '</div>';
                }
                
            } catch (error) {
                console.error('Ø®Ø·Ø£:', error);
                statusDiv.innerHTML += '<br>âŒ Ø®Ø·Ø£: ' + error.message;
            }
        }
    </script>
</body>
</html>
