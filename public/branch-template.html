<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">ØªØ­ÙÙŠØ¸ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#494776',
                        secondary: '#4F9DA6',
                        custom: '#323266',
                        accent: '#7DCCE5'
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="./assets/css/main.css">
    <style>
        body {
            font-family: 'IBM Plex Sans Arabic', sans-serif;
        }
        .title-font {
            font-family: 'IBM Plex Sans Arabic', sans-serif;
        }
        .social-icon {
            transition: all 0.3s ease;
        }
        .social-icon:hover {
            transform: translateY(-8px) scale(1.1);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }
        .social-icon:active {
            transform: translateY(-4px) scale(1.05);
        }
        .loading-skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, transparent 37%, #f0f0f0 63%);
            background-size: 400% 100%;
            animation: shimmer 1.5s ease-in-out infinite;
        }
        @keyframes shimmer {
            0% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col items-center justify-center p-4 sm:p-6">
    
    <!-- Loading State -->
    <div id="loadingState" class="w-full max-w-xs sm:max-w-sm mx-auto px-4 sm:px-0">
        <div class="text-center mb-8 sm:mb-12">
            <div class="loading-skeleton w-24 h-24 sm:w-32 sm:h-32 mx-auto rounded-2xl mb-6 sm:mb-8"></div>
            <div class="loading-skeleton w-32 h-6 mx-auto rounded-lg"></div>
        </div>
        <div class="grid grid-cols-2 gap-4 sm:gap-6 mb-8 sm:mb-12">
            <div class="loading-skeleton rounded-2xl sm:rounded-3xl min-h-[80px] sm:min-h-[100px]"></div>
            <div class="loading-skeleton rounded-2xl sm:rounded-3xl min-h-[80px] sm:min-h-[100px]"></div>
            <div class="loading-skeleton rounded-2xl sm:rounded-3xl min-h-[80px] sm:min-h-[100px]"></div>
            <div class="loading-skeleton rounded-2xl sm:rounded-3xl min-h-[80px] sm:min-h-[100px]"></div>
        </div>
    </div>

    <!-- Main Container -->
    <div id="mainContent" class="w-full max-w-xs sm:max-w-sm mx-auto px-4 sm:px-0 hidden">
        
        <!-- Header Section -->
        <div class="text-center mb-8 sm:mb-12">
            <!-- Logo -->
            <div class="mb-6 sm:mb-8">
                <img src="./Logo.png" alt="ØªØ­ÙÙŠØ¸ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©" class="w-24 h-24 sm:w-32 sm:h-32 mx-auto object-contain">
            </div>
            
            <!-- Branch Info -->
            <p id="branchName" class="text-primary text-base sm:text-lg font-semibold px-2">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
        </div>

        <!-- Social Icons Grid -->
        <div class="grid grid-cols-2 gap-4 sm:gap-6 mb-8 sm:mb-12" id="socialGrid">
            <!-- Icons will be generated dynamically -->
        </div>

        <!-- Action Buttons -->
        <div class="text-center mb-6 sm:mb-8">
            <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center items-center">
                <!-- Online Store Button -->
                <button id="storeBtn" class="bg-primary hover:bg-opacity-80 text-white font-semibold py-3 px-6 sm:py-4 sm:px-8 rounded-xl sm:rounded-2xl shadow-lg transform transition-all duration-300 hover:scale-105 hover:shadow-xl flex items-center justify-center gap-2 sm:gap-3 text-sm sm:text-base w-full sm:w-auto">
                    <i class="fas fa-shopping-cart text-lg sm:text-xl"></i>
                    <span>Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</span>
                </button>
                
                <!-- Share Button -->
                <button id="shareBtn" class="bg-custom hover:bg-opacity-80 text-white font-semibold py-3 px-6 sm:py-4 sm:px-8 rounded-xl sm:rounded-2xl shadow-lg transform transition-all duration-300 hover:scale-105 hover:shadow-xl flex items-center justify-center gap-2 sm:gap-3 text-sm sm:text-base w-full sm:w-auto">
                    <i class="fas fa-share-alt text-lg sm:text-xl"></i>
                    <span>Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØµÙØ­Ø©</span>
                </button>
            </div>
        </div>

        <!-- Additional Info -->
        <div class="text-center">
            <div class="w-16 h-0.5 bg-gradient-to-r from-transparent via-primary to-transparent mx-auto mb-4"></div>
            <p class="text-gray-400 text-xs">Â© Ù¢Ù Ù¢Ù¤ ØªØ­ÙÙŠØ¸ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</p>
        </div>
    </div>

    <!-- Error State -->
    <div id="errorState" class="hidden text-center">
        <div class="bg-red-50 border border-red-200 rounded-2xl p-6 max-w-md mx-auto">
            <i class="fas fa-exclamation-triangle text-red-500 text-4xl mb-4"></i>
            <h3 class="text-red-800 font-bold text-lg mb-2">ÙØ±Ø¹ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯</h3>
            <p class="text-red-600 mb-4">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</p>
            <a href="./home.html" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-xl transition-colors inline-flex items-center gap-2">
                <i class="fas fa-home"></i>
                <span>Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
            </a>
        </div>
    </div>

    <script src="./assets/js/supabase-service.js"></script>
    <script>
        class BranchPageManager {
            constructor() {
                this.branchId = this.getBranchIdFromURL();
                this.branchData = null;
                this.init();
            }

            getBranchIdFromURL() {
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ø±Ù Ø§Ù„ÙØ±Ø¹ Ù…Ù† URL
                const urlParams = new URLSearchParams(window.location.search);
                const fromParam = urlParams.get('branch');
                
                if (fromParam) {
                    return fromParam;
                }

                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ù† Ø§Ù„Ù…Ø³Ø§Ø±
                const pathSegments = window.location.pathname.split('/').filter(segment => segment);
                const lastSegment = pathSegments[pathSegments.length - 1];
                
                // Ø¥Ø²Ø§Ù„Ø© .html Ø¥Ù† ÙˆØ¬Ø¯
                return lastSegment.replace('.html', '');
            }

            async init() {
                try {
                    console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªÙ‡ÙŠØ¦Ø© ØµÙØ­Ø© Ø§Ù„ÙØ±Ø¹...');
                    console.log('ğŸ“ Ù…Ø¹Ø±Ù Ø§Ù„ÙØ±Ø¹:', this.branchId);
                    
                    // Ø¥Ø¹Ø·Ø§Ø¡ ÙˆÙ‚Øª Ø£ÙƒØ¨Ø± Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    await this.loadBranchData();
                    
                    if (this.branchData) {
                        console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø¨Ø¯Ø¡ Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø©...');
                        this.renderBranchPage();
                        this.setupEventListeners();
                        this.showContent();
                    } else {
                        console.error('âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ø¹Ø±Ø¶ ØµÙØ­Ø© Ø§Ù„Ø®Ø·Ø£...');
                        // Ø¥Ø¹Ø·Ø§Ø¡ Ù…Ø­Ø§ÙˆÙ„Ø© Ø£Ø®ÙŠØ±Ø© Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†
                        console.log('ğŸ”„ Ù…Ø­Ø§ÙˆÙ„Ø© Ø£Ø®ÙŠØ±Ø© Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†...');
                        setTimeout(async () => {
                            await this.loadBranchData();
                            if (this.branchData) {
                                this.renderBranchPage();
                                this.setupEventListeners();
                                this.showContent();
                            } else {
                                this.showError();
                            }
                        }, 3000);
                    }
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹:', error);
                    this.showError();
                }
            }

            async loadBranchData() {
                try {
                    console.log('ğŸ”„ Ø¨Ø¯Ø¡ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹ Ù…Ù† Supabase:', this.branchId);
                    console.log('ğŸ“ URL Ø§Ù„Ø­Ø§Ù„ÙŠ:', window.location.href);
                    
                    // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø®Ø¯Ù…Ø© Supabase Ù…Ø¹ ÙˆÙ‚Øª Ø£Ø·ÙˆÙ„
                    let attempts = 0;
                    while (!window.supabaseService && attempts < 100) { // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø¥Ù„Ù‰ 100
                        console.log(`â³ Ù…Ø­Ø§ÙˆÙ„Ø© ${attempts + 1}: Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ supabaseService...`);
                        await new Promise(resolve => setTimeout(resolve, 100));
                        attempts++;
                    }
                    
                    if (!window.supabaseService) {
                        console.error('âŒ Ø®Ø¯Ù…Ø© Supabase ØºÙŠØ± Ù…ØªÙˆÙØ±Ø© Ø¨Ø¹Ø¯ 10 Ø«ÙˆØ§Ù†Ù');
                        console.error('âŒ window.supabaseService:', window.supabaseService);
                        console.error('âŒ window object keys:', Object.keys(window));
                        return false;
                    }
                    
                    if (!window.supabaseService.getBranch) {
                        console.error('âŒ Ø¯Ø§Ù„Ø© getBranch ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                        console.error('âŒ Ø§Ù„Ù…ØªØ§Ø­ ÙÙŠ supabaseService:', Object.keys(window.supabaseService));
                        return false;
                    }
                    
                    console.log('âœ… Ø®Ø¯Ù…Ø© Supabase Ù…ØªÙˆÙØ±Ø© ÙˆØ¯Ø§Ù„Ø© getBranch Ù…ÙˆØ¬ÙˆØ¯Ø©');
                    
                    // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    console.log('ğŸ” Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ getBranch Ù„Ù„ÙØ±Ø¹:', this.branchId);
                    const result = await window.supabaseService.getBranch(this.branchId);
                    console.log('ğŸ“Š Ù†ØªÙŠØ¬Ø© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', result);
                    
                    if (result.success && result.data) {
                        this.branchData = result.data;
                        console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', this.branchData.name || this.branchData.branch_name);
                        console.log('ğŸ“‹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù…Ù„Ø©:', this.branchData);
                        return true;
                    } else {
                        console.error('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ÙØ±Ø¹ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', this.branchId);
                        console.error('âŒ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø©:', result);
                        
                        // Ø¬Ø±Ø¨ Ù…Ø¹Ø±ÙØ§Øª Ø£Ø®Ø±Ù‰ Ù…Ø­ØªÙ…Ù„Ø©
                        console.log('ğŸ”„ Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø¨Ø­Ø« Ø¨Ù…Ø¹Ø±ÙØ§Øª Ø£Ø®Ø±Ù‰...');
                        const alternativeIds = ['al-khobar', 'alkhobar', 'khobar'];
                        for (const altId of alternativeIds) {
                            if (altId !== this.branchId) {
                                console.log(`ğŸ” Ø¬Ø±Ø¨ Ù…Ø¹Ø±Ù Ø¨Ø¯ÙŠÙ„: ${altId}`);
                                const altResult = await window.supabaseService.getBranch(altId);
                                if (altResult.success && altResult.data) {
                                    console.log('âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ÙØ±Ø¹ Ø¨Ù…Ø¹Ø±Ù Ø¨Ø¯ÙŠÙ„:', altId);
                                    this.branchData = altResult.data;
                                    return true;
                                }
                            }
                        }
                        return false;
                    }
                    
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                    console.error('âŒ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£:', error.stack);
                    return false;
                }
            }

            renderBranchPage() {
                console.log('ğŸ¨ Ø¨Ø¯Ø¡ Ø¹Ø±Ø¶ ØµÙØ­Ø© Ø§Ù„ÙØ±Ø¹...');
                console.log('ğŸ“‹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ Ø§Ù„Ø¹Ø±Ø¶:', this.branchData);
                
                // ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙØ­Ø©
                const pageTitle = document.getElementById('pageTitle');
                if (pageTitle) {
                    pageTitle.textContent = `ØªØ­ÙÙŠØ¸ Ø§Ù„Ø´Ø±Ù‚ÙŠØ© - ${this.branchData.name || this.branchData.branch_name || 'ÙØ±Ø¹ ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}`;
                    console.log('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙØ­Ø©:', pageTitle.textContent);
                } else {
                    console.error('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†ØµØ± pageTitle');
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹
                const branchName = document.getElementById('branchName');
                if (branchName) {
                    branchName.textContent = this.branchData.name || this.branchData.branch_name || 'ÙØ±Ø¹ ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                    console.log('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹:', branchName.textContent);
                } else {
                    console.error('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†ØµØ± branchName');
                }

                // Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ
                console.log('ğŸ”— Ø¨Ø¯Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„...');
                this.renderSocialIcons();
                console.log('âœ… Ø§Ù†ØªÙ‡Ø§Ø¡ Ø¹Ø±Ø¶ ØµÙØ­Ø© Ø§Ù„ÙØ±Ø¹');
            }

            renderSocialIcons() {
                const socialGrid = document.getElementById('socialGrid');
                socialGrid.innerHTML = '';

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ù‚Ø¨Ù„ Ø§Ù„Ø¹Ø±Ø¶
                function isValidField(value) {
                    return value && value.trim() !== '' && value !== 'null' && value !== null;
                }

                const socialPlatforms = [
                    {
                        name: 'twitter',
                        icon: 'fab fa-twitter',
                        url: isValidField(this.branchData.twitter) ? this.branchData.twitter : null,
                        color: 'text-white'
                    },
                    {
                        name: 'whatsapp',
                        icon: 'fab fa-whatsapp',
                        url: isValidField(this.branchData.whatsapp) ? `https://wa.me/${this.branchData.whatsapp.replace(/[^\d]/g, '')}` : null,
                        color: 'text-white'
                    },
                    {
                        name: 'instagram',
                        icon: 'fab fa-instagram',
                        url: isValidField(this.branchData.instagram) ? this.branchData.instagram : null,
                        color: 'text-white'
                    },
                    {
                        name: 'location',
                        icon: 'fas fa-map-marker-alt',
                        url: isValidField(this.branchData.location) ? this.branchData.location : null,
                        color: 'text-white'
                    }
                ];

                // Ø¥Ø¸Ù‡Ø§Ø± ÙÙ‚Ø· Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø©
                const availablePlatforms = socialPlatforms.filter(platform => platform.url);
                console.log('ğŸ”— Ø§Ù„Ù…Ù†ØµØ§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø©:', availablePlatforms.map(p => p.name));

                availablePlatforms.forEach((platform, index) => {
                    if (platform.url) {
                        const iconElement = this.createSocialIcon(platform, index);
                        socialGrid.appendChild(iconElement);
                    }
                });
                
                if (availablePlatforms.length === 0) {
                    console.log('âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø· Ù…ØªÙˆÙØ±Ø© Ù„Ù„Ø¹Ø±Ø¶');
                }
            }

            createSocialIcon(platform, index) {
                const link = document.createElement('a');
                link.href = platform.url;
                link.target = '_blank';
                link.className = 'social-icon bg-custom rounded-2xl sm:rounded-3xl p-4 sm:p-6 flex items-center justify-center aspect-square shadow-lg min-h-[80px] sm:min-h-[100px] opacity-0';
                link.style.animationDelay = `${index * 100 + 500}ms`;
                
                link.innerHTML = `<i class="${platform.icon} ${platform.color} text-3xl sm:text-5xl"></i>`;
                
                // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ù‚Ø±
                link.addEventListener('click', (e) => {
                    this.handleSocialClick(platform.name, e);
                });

                // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù†
                setTimeout(() => {
                    link.style.opacity = '1';
                    link.style.animation = 'fadeInUp 0.6s ease forwards';
                }, index * 100 + 500);

                return link;
            }

            handleSocialClick(platform, e) {
                console.log(`ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ ${platform}`);
                
                // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ø³ØªØ®Ø¯Ø§Ù… (ÙŠÙ…ÙƒÙ† Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§ Ù„Ù€ Firebase Analytics Ù„Ø§Ø­Ù‚Ø§Ù‹)
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'social_click', {
                        'social_platform': platform,
                        'branch_id': this.branchId
                    });
                }
            }

            setupEventListeners() {
                // Ø²Ø± Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ - Ù…Ø¹Ø·Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹
                document.getElementById('storeBtn').addEventListener('click', () => {
                    this.showComingSoon('storeBtn', 'Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ø¬Ø¯Ø§Ù‹!');
                });

                // Ø²Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
                document.getElementById('shareBtn').addEventListener('click', () => {
                    this.handleShare();
                });
            }

            async handleShare() {
                const shareData = {
                    title: `ØªØ­ÙÙŠØ¸ Ø§Ù„Ø´Ø±Ù‚ÙŠØ© - ${this.branchData.name || this.branchData.branch_name || 'ÙØ±Ø¹ ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}`,
                    text: `Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ ØªØ­ÙÙŠØ¸ Ø§Ù„Ø´Ø±Ù‚ÙŠØ© - ${this.branchData.name || this.branchData.branch_name || 'ÙØ±Ø¹ ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}`,
                    url: window.location.href
                };

                try {
                    if (navigator.share && navigator.canShare(shareData)) {
                        await navigator.share(shareData);
                        console.log('ØªÙ… Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¨Ù†Ø¬Ø§Ø­');
                    } else {
                        await navigator.clipboard.writeText(window.location.href);
                        this.showSuccess('shareBtn', 'ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·!');
                    }
                } catch (err) {
                    console.log('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©:', err);
                    this.showFallbackShare();
                }
            }

            showFallbackShare() {
                const shareText = `ØªØ­ÙÙŠØ¸ Ø§Ù„Ø´Ø±Ù‚ÙŠØ© - ${this.branchData.name || this.branchData.branch_name || 'ÙØ±Ø¹ ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}\n${window.location.href}`;
                const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(shareText)}`;
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}`;
                
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4';
                modal.innerHTML = `
                    <div class="bg-white rounded-2xl p-6 max-w-sm w-full">
                        <h3 class="text-lg font-bold text-primary mb-4 text-center">Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØµÙØ­Ø©</h3>
                        <div class="space-y-3">
                            <a href="${whatsappUrl}" target="_blank" 
                               class="w-full bg-green-500 hover:bg-green-600 text-white p-3 rounded-xl flex items-center justify-center gap-2 transition-colors">
                                <i class="fab fa-whatsapp"></i>
                                <span>ÙˆØ§ØªØ³Ø§Ø¨</span>
                            </a>
                            <a href="${twitterUrl}" target="_blank" 
                               class="w-full bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-xl flex items-center justify-center gap-2 transition-colors">
                                <i class="fab fa-twitter"></i>
                                <span>ØªÙˆÙŠØªØ±</span>
                            </a>
                            <button onclick="this.closest('.fixed').remove()" 
                                    class="w-full bg-gray-300 hover:bg-gray-400 text-gray-700 p-3 rounded-xl transition-colors">
                                Ø¥Ù„ØºØ§Ø¡
                            </button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });
            }

            showComingSoon(buttonId, message) {
                const button = document.getElementById(buttonId);
                const originalHTML = button.innerHTML;
                
                button.innerHTML = '<i class="fas fa-clock text-lg sm:text-xl"></i><span>Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ø¬Ø¯Ø§Ù‹!</span>';
                button.classList.remove('bg-primary');
                button.classList.add('bg-secondary');
                
                setTimeout(() => {
                    button.innerHTML = originalHTML;
                    button.classList.remove('bg-secondary');
                    button.classList.add('bg-primary');
                }, 2000);
            }

            showSuccess(buttonId, message) {
                const button = document.getElementById(buttonId);
                const originalHTML = button.innerHTML;
                
                button.innerHTML = '<i class="fas fa-check text-lg sm:text-xl"></i><span>ØªÙ… Ø§Ù„Ù†Ø³Ø®!</span>';
                button.classList.add('bg-green-500');
                
                setTimeout(() => {
                    button.innerHTML = originalHTML;
                    button.classList.remove('bg-green-500');
                }, 2000);
            }

            showContent() {
                document.getElementById('loadingState').classList.add('hidden');
                document.getElementById('mainContent').classList.remove('hidden');
            }

            showError() {
                document.getElementById('loadingState').classList.add('hidden');
                document.getElementById('errorState').classList.remove('hidden');
            }
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        document.addEventListener('DOMContentLoaded', () => {
            window.branchPageManager = new BranchPageManager();
        });
    </script>
</body>
</html>
